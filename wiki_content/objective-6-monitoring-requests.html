<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Objective 6 - Monitoring Requests</title>
<meta name="identifier" content="g27c30be0af4e2d1c792736e61b6b445b"/>
<meta name="editing_roles" content="teachers"/>
<meta name="workflow_state" content="active"/>
</head>
<body>
<div class=" border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
<h3><strong>Overview</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
<p><span>This objective focuses on how to track the status of asynchronous operations in RTK Query. Using RTK Query's hooks, we can access the state of each request, including loading, success, and error states, which can be used to inform the UI and enhance user experience</span>.</p>
</div>
<div class="border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
<h3><strong>How to Build It</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
<h4><strong>Extracting Request Status from RTK Query</strong></h4>
<p><span>When we use RTK Query's hooks for fetching data (</span><code>useGetUsersQuery</code><span>) or performing mutations (</span><code>useCreateUserMutation</code><span>), we get several pieces of state that describe the status of the associated request. This status can be used to display loaders, success messages, or error messages</span>.</p>
<p><span>In the provided screenshot of </span><code>App.js</code><span>, we can observe the usage of destructuring to extract various states from RTK Query's hooks:</span></p>
<pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.555556px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// frontend/components/App.js</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">React</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'react'</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> { useGetUsersQuery, useCreateUserMutation } <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'../state/usersApi'</span><br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">export</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">default</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">function</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">App</span>() {<br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// Destructuring the state and functions from the useGetUsersQuery hook</span><br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">data</span>: users,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">error</span>: usersError,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">isLoading</span>: usersLoading,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">isFetching</span>: usersFetching,<br>&nbsp;&nbsp;} = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">useGetUsersQuery</span>()<br><br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// Destructuring the mutation function and related state from useCreateUserMutation</span><br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> [createUser, {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">error</span>: creationError,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">isLoading</span>: userCreating,<br>&nbsp;&nbsp;}] = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">useCreateUserMutation</span>()<br><br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// Rest of the component</span><br>}</code><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><br></code></pre>
<h4><strong>Understanding the Destructured State</strong></h4>
<ul>
<li>
<p><code>data</code>: This is the response from our query or mutation. In the case of <code>useGetUsersQuery</code>, it would be the list of users returned from our server.</p>
</li>
<li>
<p><code>isLoading</code>: A boolean that indicates if the query/mutation has been initiated but a response has not yet been received.</p>
</li>
<li>
<p><code>isFetching</code>: Similar to <code>isLoading</code>, but specifically for queries, it remains true for as long as a request is in-flight, including background refetching.</p>
</li>
<li>
<p><code>error</code>: Contains error information if the query or mutation fails.</p>
</li>
</ul>
<h4><strong>Usage in UI</strong></h4>
<p><span>We can use these states to provide feedback in the UI, such as displaying loading indicators or error messages. For example, we could render a spinner while </span><code>usersLoading</code><span> or </span><code>userCreating</code><span> is true, and display </span><code>creationError.message</code><span> if an error occurs during user creation.</span></p>
<pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.555556px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// Inside the App component's return statement</span><br><br>{<br>&nbsp;&nbsp;usersLoading ? <span><span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">p</span>&gt;</span>Loading users...<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">p</span>&gt;</span></span> : (<br>&nbsp;&nbsp;&nbsp;&nbsp;<span><span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">ul</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{users?.map(user =&gt; <span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">div</span> <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">key</span>=<span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">{user.id}</span>&gt;</span>{user.username}<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">div</span>&gt;</span>)}<br>&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">ul</span>&gt;</span></span><br>&nbsp;&nbsp;)<br>}<br><br>{<br>&nbsp;&nbsp;userCreating &amp;&amp; <span><span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">p</span>&gt;</span>Creating user...<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">p</span>&gt;</span></span><br>}<br><br>{<br>&nbsp;&nbsp;creationError &amp;&amp; <span><span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">p</span>&gt;</span>Error creating user: {creationError.message}<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">p</span>&gt;</span></span><br>}<br></code></pre>
<p><span>By monitoring the request status provided by RTK Query hooks, we gain fine-grained control over the user interface, allowing us to react to changes in request state and provide a responsive and informative experience for the end-user.</span></p>
</div>
<div class="border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
<h3><strong>Video Walkthrough</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
<p><iframe class="wistia_embed" title="Understanding Redux" src="https://fast.wistia.net/embed/iframe/3ilmf2knxr?seo=false&amp;videoFoam=false" width="640" height="360" name="wistia_embed" allow="autoplay; fullscreen" loading="lazy"></iframe></p>
</div>
</body>
</html>