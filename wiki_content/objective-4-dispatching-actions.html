<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Objective 4 - Dispatching Actions</title>
<meta name="identifier" content="g3024662530492b43eb049289606fa8da"/>
<meta name="editing_roles" content="teachers"/>
<meta name="workflow_state" content="active"/>
</head>
<body>
<div class=" border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
    <h3><strong>Overview</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
    <p><span>This section provides a comprehensive guide on dispatching actions within a React application, focusing on the Redux Toolkit framework. We will cover essential aspects such as actions and payloads. To do this, we will expand on the the basic 'counter' Redux app from Objective 2, and implement a new feature to track savings, as well as to save and spend money!</span></p>
</div>
<div class="border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
    <h3><strong>How to Build It</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
    <h4><strong>Initialization of State in Slice</strong></h4>
    <p>We will add a new state property, 'savings', in the Redux slice. The initial value of 'savings' will be set at $10. To go along with this new state, reducers will be needed to handle adding money to savings, and spending money from savings. Finally, we will expose to other modules the action creator functions that will trigger their corresponding reducers:</p>
    <pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.555556px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// frontend/state/slice.js</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> { createSlice } <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'@reduxjs/toolkit'</span><br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> slice = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">createSlice</span>({<br>&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'count_state'</span>, <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// ❗ feel free to use a better name</span><br>&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">initialState</span>: { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">savings</span>: <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">10</span>, <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">/* other states */</span> },<br>&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">reducers</span>: {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">save</span>(<span>state, action</span>) { <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">/* TODO */</span> },<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">spend</span>(<span>state, action</span>) { <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">/* TODO */</span> },<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// other reducers</span><br>&nbsp;&nbsp;}<br>})<br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">export</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">default</span> slice.<span>reducer</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">export</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> { save, spend, <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">/* other actions */</span> } = slice.<span>actions</span></code></pre>
    <p>You might notice that the 'spend' and 'save' reducers are accepting a second argument we haven't used so far, but which should be familiar from The Reducer Pattern: the action object. The action is important if the action 'type' on its own is not enough for the reducer to know how exactly&nbsp; to compute the next state. How much are we spending? How much are we saving? That kind of information will come included inside the action object.</p>
  <p>&nbsp;</p>  
  <h4><strong>Dispatching Spend and Save Actions</strong></h4>
    <p>From the side of the component that displays our savings and allows us to save and spend (hopefully more of the former):</p>
    <pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.555556px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// frontend/components/App.js</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">React</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'react'</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> { useSelector, useDispatch } <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'react-redux'</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> { save, spend } <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'../state/slice'</span><br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">export</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">default</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">function</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">App</span>() {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> savings = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">useSelector</span>(<span><span>st</span> =&gt;</span> st.<span>counters</span>.<span>savings</span>) <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// ❗ assuming a 'counters' slice</span><br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> dispatch = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">useDispatch</span>()<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> (<br>&nbsp;&nbsp;&nbsp;&nbsp;<span><span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">div</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">h2</span>&gt;</span>My savings are at ${savings}<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">h2</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">button</span> <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">onClick</span>=<span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">{()</span> =&gt;</span> {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const saveAction = save(10) // ❗ note the 10<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispatch(saveAction)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}&gt;Save $10<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">button</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">button</span> <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">onClick</span>=<span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">{()</span> =&gt;</span> {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const spendAction = spend(5)&nbsp;&nbsp;// ❗ note the 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dispatch(spendAction)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}}&gt;Spend $5<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">button</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/<span style="border: 0px none #22863a; color: #22863a; text-decoration: none solid #22863a;">div</span>&gt;</span></span><br>&nbsp;&nbsp;)<br>}</code></pre>
    <p>It makes sense that we supply the amount we wish to save (or spend) as the argument to each action creator. But where does this amount end up? To try and answer that question, we can console log 'saveAction' and 'spendAction':</p>
    <pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.555556px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">console</span>.<span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">log</span>(saveAction) <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// prints { type: 'count_state/save', payload: 10 }</span><br><span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// etc</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">console</span>.<span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">log</span>(spendAction) <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// prints { type: 'count_state/spend', payload: 5 }</span></code></pre>
    <p>Mystery solved! Whatever data we pass as the argument to the action creator ends up as <code>action.payload</code> inside the action object. No wonder these functions are called action creators! And unlike with The Reducer Pattern, these functions are provided to us by Redux Toolkit so we don't have to write them manually, nor juggle the typo-prone action type strings.</p>
  <p>&nbsp;</p>  
  <h4><strong>Implementing Save and Spend Reducers</strong></h4>
    <p>Reducers never sleep! They are always waiting for an action to be dispatched by a component. If we use the save and spend buttons which we have implemented in the App component, this is how it will play out:</p>
    <pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.555556px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// frontend/state/slice.js</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">import</span> { createSlice } <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">from</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'@reduxjs/toolkit'</span><br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> slice = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">createSlice</span>({<br>&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'count_state'</span>,<br>&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">initialState</span>: { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">savings</span>: <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">10</span>, <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">/* other states */</span> },<br>&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">reducers</span>: {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">save</span>(<span>state, action</span>) { <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// ❗ the action payload contains 10</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state.<span>savings</span> += action.<span>payload</span><br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">spend</span>(<span>state, action</span>) { <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// ❗ the action payload contains 5</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">if</span> (state.<span>savings</span> &gt; action.<span>payload</span>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state.<span>savings</span> -= action.<span>payload</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">else</span> {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// ❗ we don't want to end up with negative savings!</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state.<span>savings</span> = <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// other reducers</span><br>&nbsp;&nbsp;}<br>})<br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">export</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">default</span> slice.<span>reducer</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">export</span> <span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> { save, spend, <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">/* other actions */</span> } = slice.<span>actions</span></code></pre>
    <p>Having closed the development loop, the spend and save buttons work as expected! We can inspect the actions and payloads in detail, using Redux Dev Tools. We can even time-travel to past states, by clicking on a past action!</p>
    <p><img src="$IMS-CC-FILEBASE$/Uploaded%20Media/dispatching-actions.png" alt="dispatching actions" data-api-endpoint="https://bloomtech.instructure.com/api/v1/courses/2204/files/746828" data-api-returntype="File" loading="lazy"></p>
    <p>&nbsp;</p>
</div>
<div class="border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
    <h3><strong>Video Walkthrough</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
    <p><iframe class="wistia_embed" title="Dispatching Actions" src="https://fast.wistia.net/embed/iframe/18sek1w481?seo=false&amp;videoFoam=false" width="640" height="360" name="wistia_embed" allow="autoplay; fullscreen" loading="lazy"></iframe></p>
</div>
</body>
</html>