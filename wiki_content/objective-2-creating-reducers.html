<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Objective 2 - Creating Reducers</title>
<meta name="identifier" content="g35afaede859a3605573369d853a23503"/>
<meta name="editing_roles" content="teachers"/>
<meta name="workflow_state" content="active"/>
</head>
<body>
<div class=" border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
<h3><strong>Overview</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
<p>Reducer functions take two arguments: the current state and and an action. Then, a new, updated state object based on both arguments is returned.</p>
<p>In pseudocode, this looks like this:</p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="less"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"> (<span style="border: 0px none #22863a; color: #22863a;">state</span>, <span style="border: 0px none #22863a; color: #22863a;">action</span>) =&gt; <span style="border: 0px none #22863a; color: #22863a;">newState</span></code></pre>
<p>This seemingly simple idea is going to allow us to clean up our React components, by removing state calculations from them. Reducers also will unlock the ability to create extremely complex applications, beyond what we would be able to achieve with the State hook alone.</p>
</div>
<div class="border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
<h3><strong>How to Build It</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
<p><span>Consider a function in JavaScript that, when passed to an integer, would return that value + 1, without mutating the original integer's value. Notice we could pass our initialState value - 0 - and then return a new value - 1 - without overriding the initialState.</span></p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"><span style="border: 0px none #d73a49; color: #d73a49;">const</span> initialState = <span style="border: 0px none #005cc5; color: #005cc5;">0</span><br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> <span style="border: 0px none #6f42c1; color: #6f42c1;">reducer</span> = (<span>state</span>) =&gt; {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49;">const</span> newState = state + <span style="border: 0px none #005cc5; color: #005cc5;">1</span><br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49;">return</span> newState;<br>}<br><br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> newStateValue = <span style="border: 0px none #6f42c1; color: #6f42c1;">reducer</span>(initialState);<br><span style="border: 0px none #d73a49; color: #d73a49;">console</span>.<span style="border: 0px none #6f42c1; color: #6f42c1;">log</span>(initialState, newStateValue); <span style="border: 0px none #6a737d; color: #6a737d;">// 0, 1</span></code></pre>
<p>Often, returning something such as an integer or a string is not the best choice, especially as data grows more complex.</p>
<p><span style="color: var(--ic-brand-font-color-dark); font-family: inherit; font-size: 1rem;">Let's consider instead using an object as the data structure of choice for state:</span></p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"><span style="border: 0px none #d73a49; color: #d73a49;">const</span> initialState = { <span style="border: 0px none #005cc5; color: #005cc5;">count</span>: <span style="border: 0px none #005cc5; color: #005cc5;">0</span> }<br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> <span style="border: 0px none #6f42c1; color: #6f42c1;">reducer</span> = (<span>state</span>) =&gt; {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5;">count</span>: state.<span>count</span> + <span style="border: 0px none #005cc5; color: #005cc5;">1</span> }<br>}</code></pre>
<p>Again, we are returning a <em>new</em> object and are not directly mutating or overriding the <code>initialState</code> object.</p>
<p><span>This reducer function is a pure function without any side effects. Therefore, reducer functions are the perfect fit for managing changes in state in an immutable manner.</span></p>
<p>We've discussed the nature of the incoming state value, but what about the action?</p>
<p>The action, represented by an object, contains information related to some action that happens in our app. Every action object is required to have a <code>type</code> property, which will tell the reducer what's going on inside the app. Specifically, the <code>type</code> allows the reducer to know what parts of the state need to change.</p>
<p>Fleshing out the reducer above a bit more, let's notify the reducer that we want to increment our count state by passing in an <code>action</code> with <code>'increment'</code> as the type.</p>
<pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.666667px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> initialState = { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">0</span> }<br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span> = (<span>state, action</span>) =&gt; {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">if</span> (action.<span>type</span> === <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: state.<span>count</span> + <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">1</span> }<br>&nbsp;&nbsp;}<br>}<br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> nextState = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(initialState, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span> })</code></pre>
<p><span>This strategy is especially powerful when we want our reducer to be able to reduce the state. Let's flesh it out a bit more, by adding more cases:</span></p>
<pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.666667px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> initialState = { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">0</span> }<br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span> = (<span>state, action</span>) =&gt; {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">if</span> (action.<span>type</span> === <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: state.<span>count</span> + <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">1</span> }<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">if</span> (action.<span>type</span> === <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'decrement'</span>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: state.<span>count</span> - <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">1</span> }<br>&nbsp;&nbsp;}<br>}<br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> state1 = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(initialState, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span> }) <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// state1 is {count:1}</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> state2 = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(state1, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span> }) <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// state2 is {count:2}</span><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> state3 = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(state2, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'decrement'</span> }) <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// state3 is {count:1}</span></code></pre>
<p><span>Now our state management is very predictable!</span></p>
<p>We can also add a <code>payload</code> property to our action objects (sometimes called <code>data</code>). Sometimes our reducer needs to have some extra information passed into it through the action, to be able to update the state correctly, and this is where that data would live.</p>
<pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.666667px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> initialState = { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'Donald Duck'</span> }<br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span> = (<span>state, action</span>) =&gt; {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">if</span> (action.<span>type</span> === <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'changeName'</span>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// how do we know what to change the name to? The action payload!</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">name</span>: action.<span>payload</span> }<br>&nbsp;&nbsp;}<br>}<br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> nextState = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(initialState, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'changeName'</span>, <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">payload</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'Mickey Mouse'</span> });</code></pre>
<p>There's one last edit we need to make to get to production quality. As you can imagine, or <code>if</code>, <code>if else</code>, <code>if else</code> â€¦ etc, statements are going to get very complex and long. We'll use JavaScript's <code>switch</code> statement to make that part of our reducer a lot more readable:</p>
<p>Back to the count example, look at the change here:</p>
<pre style="background: none 0% 0% / auto repeat scroll padding-box border-box #ffffff; border: 0.666667px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font: 12px / 14.4px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none solid #24292e; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;" data-hljs-language="javascript"><code style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(0, 0, 0, 0); border: 0px none #24292e; font: 16px / 19.2px Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px;"><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> initialState = { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">0</span> }<br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span> = (<span>state, action</span>) =&gt; {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">switch</span>(action.<span>type</span>) {<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">case</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: state.<span>count</span> + <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">1</span> }<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">case</span> <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'decrement'</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">count</span>: state.<span>count</span> - <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">1</span> }<br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">default</span>: <span style="border: 0px none #6a737d; color: #6a737d; text-decoration: none solid #6a737d;">// this is in case the action type is unknown!</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">return</span> state<br>&nbsp;&nbsp;}<br>}<br><br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> state1 = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(initialState, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'increment'</span> })<br><span style="border: 0px none #d73a49; color: #d73a49; text-decoration: none solid #d73a49;">const</span> state2 = <span style="border: 0px none #6f42c1; color: #6f42c1; text-decoration: none solid #6f42c1;">reducer</span>(state1, { <span style="border: 0px none #005cc5; color: #005cc5; text-decoration: none solid #005cc5;">type</span>: <span style="border: 0px none #032f62; color: #032f62; text-decoration: none solid #032f62;">'decrement'</span> })</code></pre>
<p>(Read more about <code>switch</code> statements <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch">here</a>)</p>
<p>It's very important that reducers be deterministic: for the same arguments it should always return the same value. We should not mutate state directly nor cause any other side effects. There should be no randomness happening inside the reducer: a reducer is not the place to generate a random id, for example, as the function would not be deterministic anymore. And we must always return state. Do not forget to add a default case to your switch!</p>
<p>In conclusion, reducers will allow us to extract uncomfortable state recalculations out of components, so that components can focus on rendering UI, which is what they do best.</p>
</div>
<div class="border border-trbl" style="background-color: #00808c; color: #ffffff; padding: 2px 10px; border: 1px solid black;">
<h3><strong>Video Walkthrough</strong></h3>
</div>
<div class="content-box pad-box-mini border border-rbl">
<p><iframe class="wistia_embed" title="creating reducers" src="https://fast.wistia.net/embed/iframe/qtew1ubdpm?seo=false&amp;videoFoam=false" width="640" height="360" name="wistia_embed" allow="autoplay; fullscreen" loading="lazy"></iframe></p>
</div>
</body>
</html>